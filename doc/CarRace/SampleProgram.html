<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0 plus SVG 1.1//EN"
    "http://www.w3.org/2002/04/xhtml-math-svg/xhtml-math-svg.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="jp" lang="jp">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<title>Sample Program of CarRace</title>
<!-- CSS -->

<!-- Javascript -->

<!-- RDF -->

</head>
<body>





<div id="mm-div-1">
<h1>Sample Program of CarRace</h1>

<p>サンプルプログラムです．</p>

<pre><code>import com.github.kenji0717.a3cs.*;
import javax.vecmath.Vector3d;

public class S1012000 extends RaceCarBase {
    public void exec() {
        Vector3d loc = getLoc();//現在の車の座標

        Vector3d point = getPoint(13.0);//前方13メートルの座標
        Vector3d dir = getDirection(13.0);//前方13メートルの方向
        point.sub(loc);//車から見たポイントの方向
        point.normalize();//長さを1に正規化
        Vector3d left = getUnitVecX();//車の左向き方向
        Vector3d front = getUnitVecZ();//車の前方方向

        boolean noborizaka = point.y&gt;0.1;//10%以上の上り坂
        boolean kyuukaabu = front.dot(dir)&lt;0.9;//ポイント方向と車の方向の一致度が0.9以下

        double engineForce = 700.0; //エンジン出力
        if (noborizaka) engineForce += 200; //上り坂では加速
        if (kyuukaabu) engineForce = 300; //急カーブでは減速
        double steering = 0.3*point.dot(left); //左にハンドルを切る量
        double breakingForce = kyuukaabu?10.0:0.0;//急カーブの時ブレーキ
        double drift=0.0; //ドリフトしない。

        setForce(engineForce,steering,breakingForce,drift);//実際にパラメータを設定
//以下デバッグ用のプリント文(必要に応じてコメントを外す)
//if (noborizaka)System.out.println(&quot;上り坂&quot;);
//if (kyuukaabu)System.out.println(&quot;急カーブ&quot;);
//System.out.println(&quot;Debug: &quot;+getPoint());
//System.out.println(&quot;Debug: &quot;+getDirection(10.0));
//System.out.println(&quot;Debug: &quot;+getVel());
//System.out.println(&quot;Debug: &quot;+getDist());
//System.out.println(&quot;-&quot;);
    }
}
</code></pre>

<p>このソースファイルで「ベクトル変数.dot(ベクトル変数)」というプログラムが2箇所ありますが，ここでは2つのベクトルの内積を計算しています．内積を簡単に説明すると，2つのベクトルの方向の一致度とそれぞれのベクトルの長さを掛け合せた値です．上のプログラムでは内積を計算しているベクトルの長さはいずれも1.0に正規化されているので，単純に2つのベクトルの方向の一致度と考えることができます．方向がまったく同じなら1.0，完全に逆向きなら-1.0になります．</p>

<p>その他，各メソッドの説明はAPIのページのRaceCarBaseクラスを参照して下さい．</p>

<ul>
<li><a href="http://kenji0717.github.com/A3CarSim/doc/api/">APIのページ</a></li>
</ul>
</div>


</body>
</html>
